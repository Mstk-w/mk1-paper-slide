# 1ペーパースライド生成アプリ（公務員実務特化版）仕様書

## 1. 概要

本ツールは、公務員の実務（施策立案、予算要求、事業報告等）で標準的に用いられる「A3・1枚（1ペーパースライド）」の資料作成を支援・自動化するシステムである。
Gemini（AI）との対話を通じて、行政特有の論理構成に基づいた内容を言語化し、Google Slides形式（または互換形式）の視覚的な資料を自動生成する。

## 2. 技術スタック (Tech Stack)

### 2.1 コアテクノロジー

- **言語**: Python 3.12+
- **スライド生成**: `python-pptx` (PowerPoint作成), `pandas` (データ処理)
- **Web UI**: `Streamlit` (対話型インターフェースおよび可視化)
- **AI/LLM**: Gemini API (推論・構成案作成)

### 2.2 システム構成

- **ローカル環境**: ユーザーのPC上で `streamlit run app.py` として起動。
- **ブラウザ**: Chrome/Edge 等で操作。

## 3. デザイン・レイアウト仕様

### 3.1 ページ設定

- **サイズ**: A3横（420mm × 297mm）
- **グリッド**: 左右2分割（2カラム）構成。

### 3.2 レイアウト構成（「2カラム・トップダウン」方式）

センターラインを軸に左右に分割し、**視線は「左上の上から下」→「右上の上から下」**へと移動する。
各ボックスはカラム幅一杯の**横長配置**とする。

#### 【左カラム: 現状・課題】 (Why & What)

1. **(1) 背景・必要性** (Background)
2. **(2) 解決すべき必要性** (Necessity)
3. **(3) 分析と課題の特定** (Analysis)
4. **(4) 達成目標** (Goal)

#### 【右カラム: 解決策・効果】 (How & Future)

1. **(5) 具体的施策内容** (Plan)
2. **(6) 予算・リソース** (Budget)
3. **(7) 期待される効果** (Effect)
4. **(8) 今後の展開** (Future)

### 3.3 動的レイアウト調整 (Dynamic Adjustment)

- 8つのボックス全てを埋める必要はない。
- ユーザーまたはAIの判断により**「該当なし」として削除されたボックスがある場合、同カラム内の残りのボックスを自動的に拡大**し、空白を作らずきれいに配置する。
- 例: (2)(4)が無い場合 → (1)(3)だけで左カラムの縦幅を等分して配置する。

## 4. 機能仕様

### 4.1 ユーザー体験フロー (UX Flow)

1. **テーマ入力**: ブラウザ画面上でユーザーが「テーマ」を入力。
2. **AIヒアリング（壁打ち）**:
    - AIが必要情報（スライド構成要素）をチャット形式で聴取。
    - 不足している論理や数値を深掘りする。
3. **構成案提示**:
    - AIがスライド構成案（JSON構造）をドラフトとして提示。
    - ユーザーが確認・修正指示。
4. **生成実行**:
    - 「生成」ボタン押下で、動的レイアウトロジックに基づき `.pptx` を生成。
    - プレビューまたはダウンロードリンクを表示。

---
> [!NOTE]
> 本仕様書は、行政資料としての「説得力」と「作成の効率化」の両立を最優先事項として定義しています。
